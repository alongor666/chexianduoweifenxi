# 趋势分析下钻功能实现计划（文档驱动 & 一致性保障）

为了彻底符合开发文档规范并确保系统的一致性，我调整了执行顺序，严格遵循“文档优先”原则。

## 1. 文档更新 (Priority #1)

根据 **元原则 2：文档优先**，我们将首先更新功能文档，明确“趋势分析下钻”的技术规范。

*   **目标文件**: `开发文档/01_features/F015_kpi_multi_level_drilldown/README.md`
*   **更新内容**:
    *   **新增章节**: “趋势分析集成” (Integration with Trend Analysis)。
    *   **定义交互**: 明确描述“点击趋势点 -> 锁定时间上下文 -> 开启下钻”的交互流程。
    *   **技术变更**: 记录 `DrillDownControl` 组件新增 `initialData` 属性的设计决策。

## 2. 代码实现 (严格遵循文档)

### 2.1 组件标准化 (`DrillDownControl`)
*   **修改**: 为 `src/components/features/drill-down/drill-down-control.tsx` 添加 `initialData` 支持。
*   **一致性保障**: 保持原有的状态管理逻辑（Zustand）和 UI 布局不变，确保新旧功能共用同一套核心逻辑。

### 2.2 视图集成 (`WeeklyOperationalTrend`)
*   **修改**: 在 `src/components/features/weekly-operational-trend.tsx` 中实现点击交互。
*   **UI 一致性**:
    *   **对话框样式**: 严格复用 `KPICardWithDrilldown` 中的 `Dialog` 结构（Header, Title, Description），确保弹窗视觉体验完全一致。
    *   **标题规范**: 使用统一的标题格式 `"{年份}第{周}周 - 多维下钻分析"`。
    *   **反馈机制**: 点击后立即响应，与 KPI 卡片的体验保持同步。

## 3. 验证计划

*   **文档一致性**: 检查代码实现是否完全覆盖了文档中描述的场景。
*   **功能一致性**: 对比 KPI 卡片和趋势图的下钻体验，确保操作逻辑（如选择维度、面包屑导航、清除路径）完全相同。

此计划确保新功能不是“孤岛”，而是现有下钻体系的有机延伸，完全符合项目架构规范。
