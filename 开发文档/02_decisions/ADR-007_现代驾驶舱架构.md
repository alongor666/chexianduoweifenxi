# ADR-007: 现代驾驶舱架构 (Modern Cockpit Architecture)

## 状态
已采纳 (Accepted)

## 背景
原有的仪表盘设计存在三个主要问题：
1. **Tab Trap (标签页陷阱)**: 核心图表（热力图、趋势图）被隐藏在多层 Tab 中，用户无法一眼获取全局信息。
2. **Data Dump (数据倾倒)**: KPI 看板无层级地展示 16 个指标，缺乏重点。
3. **Visual Disconnect (视觉断层)**: 数字、趋势和文字洞察分离，无法形成完整的分析叙事。

## 决策
我们决定采用“企业驾驶舱 (Enterprise Cockpit)”落地方案，整体遵循 **Cockpit-Panorama-DeepDive** 三层设计模式，并对驾驶舱层进行结构重构与统一规范接入：

### 1. 驾驶舱层 (The Cockpit)
- **目标**: 提供即时的业务健康快照，统一指标口径与展示规范。
- **内容**:
  - 第一行：4个核心KPI（保费时间进度达成率、件数时间进度达成率、变动成本率、满期赔付率、费用率）按阈值着色与标签
  - 第二行：4个统计指标（落后机构、风险机构、优秀机构、总机构）
  - 第三行及以后：经营观察模块（时间进度分析、成本风险分析、健康度热力图、多维雷达、动态条形图、占比分析）
- **组件**: `EnterpriseCockpit`（新）替代 `ModernDashboard` 驾驶舱入口

### 2. 全景监控层 (The Panorama)
- **目标**: 快速发现异常和趋势。
- **内容**:
  - `BusinessTypeHeatmap` (热力图): 发现业务线异常。
  - `WeeklyOperationalTrend` (趋势图): 监控长期走势。
- **组件**: `PanoramaSection`

### 3. 深度诊断层 (Deep Dive)
- **目标**: 提供具体的归因分析。
- **内容**:
  - `BusinessTypeDualAxisChart` (效益分析)
  - `MultiDimensionRadar` (机构对比)
  - `PremiumAnalysisBarChart` (结构分析)
- **组件**: `DeepDiveSection`

## 后果
- **正向**:
  - 提升了信息获取效率（减少点击）。
  - 建立了清晰的视觉层级。
  - 实现了“从概览到细节”的自然分析流。
- **负向**:
  - 需要维护新的组件结构。
  - 暂时与旧的 Tab 页并存（过渡期）。

## 实施
- 新增 `src/components/features/enterprise-cockpit.tsx` 主组件
- 新增驾驶舱子组件行与观察模块包装：
  - `src/components/features/cockpit/kpi-metrics-row.tsx`
  - `src/components/features/cockpit/statistics-row.tsx`
  - `src/components/features/cockpit/business-observation/*`
- 在 `AnalysisTabs` 中保持 `cockpit` 入口，替换旧驾驶舱渲染为 `EnterpriseCockpit`
- 统一可视化规范接入（详见 UNIFIED_ECHARTS_ARCHITECTURE.md）
