# weekpi-html ä½¿ç”¨ç¤ºä¾‹

## åœºæ™¯1: åŸºç¡€ç”¨æ³• - ç”Ÿæˆå•æ–‡ä»¶HTML

### æ­¥éª¤

```bash
# 1. è¿›å…¥è„šæœ¬ç›®å½•
cd .claude/skills/weekpi-html/scripts

# 2. è¿è¡Œç”Ÿæˆå‘½ä»¤
python generate_html_dashboard.py ../examples/sample_data.csv 49 å››å·åˆ†å…¬å¸ ../references

# 3. æŸ¥çœ‹è¾“å‡º
# ç”Ÿæˆæ–‡ä»¶: è½¦é™©ç¬¬49å‘¨ç»è¥åˆ†æ_å››å·åˆ†å…¬å¸_20251209.html
```

### é¢„æœŸè¾“å‡º

```
âœ… HTMLä»ªè¡¨ç›˜ç”ŸæˆæˆåŠŸ: è½¦é™©ç¬¬49å‘¨ç»è¥åˆ†æ_å››å·åˆ†å…¬å¸_20251209.html
ğŸ“Š æ•°æ®æ¦‚è§ˆ: ç­¾å•ä¿è´¹ 9,720,000å…ƒ, å˜åŠ¨æˆæœ¬ç‡ 95.8%
âš ï¸  é—®é¢˜æœºæ„: æˆåæœºæ„(æˆæœ¬è¶…æ ‡), é‡‘ç‰›æœºæ„(æˆæœ¬è¶…æ ‡)

ğŸ‰ ç”Ÿæˆå®Œæˆ!
ğŸ“„ è¾“å‡ºæ–‡ä»¶: /path/to/è½¦é™©ç¬¬49å‘¨ç»è¥åˆ†æ_å››å·åˆ†å…¬å¸_20251209.html
ğŸ’¡ ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€æ–‡ä»¶å³å¯æŸ¥çœ‹äº¤äº’å¼ä»ªè¡¨ç›˜
```

### ä½¿ç”¨HTMLæ–‡ä»¶

1. åŒå‡»æ‰“å¼€HTMLæ–‡ä»¶ï¼ˆä½¿ç”¨é»˜è®¤æµè§ˆå™¨ï¼‰
2. æˆ–è€…å³é”® -> æ‰“å¼€æ–¹å¼ -> é€‰æ‹©æµè§ˆå™¨

### äº¤äº’åŠŸèƒ½

- **æ ‡ç­¾é¡µåˆ‡æ¢**: ç‚¹å‡»é¡¶éƒ¨æ ‡ç­¾ï¼ˆç»è¥æ¦‚è§ˆã€ä¿è´¹è¿›åº¦ã€å˜åŠ¨æˆæœ¬ã€æŸå¤±æš´éœ²ã€è´¹ç”¨æ”¯å‡ºï¼‰
- **ç»´åº¦åˆ‡æ¢**: ç‚¹å‡» [æŒ‰æœºæ„] æˆ– [æŒ‰å®¢æˆ·ç±»åˆ«] æŒ‰é’®
- **å›¾è¡¨äº¤äº’**: é¼ æ ‡æ‚¬åœæŸ¥çœ‹è¯¦æƒ…ï¼Œç‚¹å‡»æ•°æ®ç‚¹é«˜äº®æ˜¾ç¤º
- **ç¼©æ”¾å¹³ç§»**: ECharts åŸç”Ÿæ”¯æŒï¼ˆä½¿ç”¨é¼ æ ‡æ»šè½®å’Œæ‹–æ‹½ï¼‰

---

## åœºæ™¯2: ä½¿ç”¨Excelæ•°æ®

```bash
# å‡è®¾æ•°æ®æ–‡ä»¶ä¸º data.xlsx
python generate_html_dashboard.py /path/to/data.xlsx 50 é«˜æ–°æœºæ„ ../references
```

---

## åœºæ™¯3: ä½¿ç”¨JSONæ•°æ®

```bash
# å‡è®¾æ•°æ®æ–‡ä»¶ä¸º data.json
python generate_html_dashboard.py /path/to/data.json 51 æˆåæœºæ„ ../references
```

---

## åœºæ™¯4: è‡ªå®šä¹‰è¾“å‡ºè·¯å¾„

```bash
# ä¿®æ”¹è„šæœ¬ä¸­çš„ generate_html() è°ƒç”¨
generator = HTMLDashboardGenerator(data_file, week, organization, config_dir)
output_path = generator.generate_html('/path/to/custom_output.html')
```

---

## åœºæ™¯5: æ— ä¿è´¹è®¡åˆ’é…ç½®

å¦‚æœæ²¡æœ‰ `references/plans.json` æ–‡ä»¶:

```bash
python generate_html_dashboard.py ../examples/sample_data.csv 49 å››å·åˆ†å…¬å¸ ../references
```

**è¾“å‡ºæç¤º**:
```
è­¦å‘Š: é…ç½®æ–‡ä»¶ plans.json ä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤é…ç½®
âœ… HTMLä»ªè¡¨ç›˜ç”ŸæˆæˆåŠŸ: ...
```

**å½±å“**: ç»è¥æ¦‚è§ˆä¸­çš„å››è±¡é™å›¾å°†ä¸æ˜¾ç¤ºå¹´è®¡åˆ’è¾¾æˆç‡ç»´åº¦ã€‚

---

## æ•°æ®æ–‡ä»¶è¦æ±‚

### å¿…éœ€å­—æ®µ

| å­—æ®µå | ç±»å‹ | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|------|
| æœºæ„ | æ–‡æœ¬ | ä¸‰çº§æœºæ„åç§° | "é«˜æ–°æœºæ„" |
| å®¢æˆ·ç±»åˆ« | æ–‡æœ¬ | å®¢æˆ·åˆ†ç±» | "å®¶ç”¨è½¦" |
| ç­¾å•ä¿è´¹ | æ•°å€¼ | æœ¬å‘¨ä¿è´¹æ”¶å…¥ï¼ˆå…ƒï¼‰ | 1500000 |
| æ»¡æœŸèµ”ä»˜ç‡ | æ•°å€¼ | ç™¾åˆ†æ¯”å€¼ | 68.5 |
| è´¹ç”¨ç‡ | æ•°å€¼ | ç™¾åˆ†æ¯”å€¼ | 18.2 |
| å˜åŠ¨æˆæœ¬ç‡ | æ•°å€¼ | ç™¾åˆ†æ¯”å€¼ | 86.7 |
| å·²æŠ¥å‘Šèµ”æ¬¾ | æ•°å€¼ | å·²æŠ¥æ¡ˆèµ”æ¬¾ï¼ˆå…ƒï¼‰ | 1027500 |
| å‡ºé™©ç‡ | æ•°å€¼ | ç™¾åˆ†æ¯”å€¼ | 22.3 |
| æ¡ˆå‡èµ”æ¬¾ | æ•°å€¼ | å¹³å‡æ¯æ¡ˆèµ”æ¬¾ï¼ˆå…ƒï¼‰ | 5800 |

### æ•°æ®ç¤ºä¾‹

å‚è§ `examples/sample_data.csv`

---

## é…ç½®æ–‡ä»¶è¯´æ˜

### references/thresholds.json

å®šä¹‰é˜ˆå€¼å’ŒçŠ¶æ€è¯„ä»·æ ‡å‡†:

```json
{
  "å››è±¡é™åŸºå‡†çº¿": {
    "ä¿è´¹è¾¾æˆç‡": 100,
    "å˜åŠ¨æˆæœ¬ç‡": 90,
    "æ»¡æœŸèµ”ä»˜ç‡": 70,
    "è´¹ç”¨ç‡": 18
  },
  "é—®é¢˜æœºæ„è¯†åˆ«é˜ˆå€¼": {
    "å¹´ä¿è´¹æœªè¾¾æ ‡": 95,
    "å˜åŠ¨æˆæœ¬ç‡è¶…æ ‡": 95,
    "æ»¡æœŸèµ”ä»˜ç‡è¶…æ ‡": 75,
    "è´¹ç”¨ç‡è¶…æ ‡": 20
  }
}
```

**è‡ªå®šä¹‰æ–¹å¼**: ç›´æ¥ç¼–è¾‘ JSON æ–‡ä»¶ä¸­çš„æ•°å€¼ã€‚

### references/plans.json

ä¿è´¹è®¡åˆ’æ•°æ®ï¼ˆå¯é€‰ï¼‰:

```json
{
  "å¹´åº¦ä¿è´¹è®¡åˆ’": {
    "å››å·åˆ†å…¬å¸": 500000000,
    "é«˜æ–°æœºæ„": 80000000
  },
  "å‘¨ä¿è´¹è®¡åˆ’": {
    "ç¬¬49å‘¨": {
      "å››å·åˆ†å…¬å¸": 10000000,
      "é«˜æ–°æœºæ„": 1600000
    }
  }
}
```

**è‡ªå®šä¹‰æ–¹å¼**: æ·»åŠ æˆ–ä¿®æ”¹æœºæ„çš„è®¡åˆ’æ•°æ®ã€‚

---

## å¸¸è§é—®é¢˜

### Q1: ç”Ÿæˆçš„HTMLæ–‡ä»¶æ— æ³•æ‰“å¼€?

**A**: æ£€æŸ¥æ–‡ä»¶æ‰©å±•åæ˜¯å¦ä¸º `.html`ï¼Œç¡®ä¿ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€ï¼ˆChromeã€Firefoxã€Safariç­‰ï¼‰ã€‚

### Q2: å›¾è¡¨ä¸æ˜¾ç¤º?

**A**: ç¡®ä¿æœ‰ç½‘ç»œè¿æ¥ï¼ŒEChartsåº“é€šè¿‡CDNåŠ è½½ã€‚å¦‚éœ€ç¦»çº¿ä½¿ç”¨ï¼Œå¯ä¸‹è½½EChartså¹¶ä¿®æ”¹è„šæœ¬ä¸­çš„å¼•ç”¨è·¯å¾„ã€‚

### Q3: æ•°æ®å­—æ®µç¼ºå¤±é”™è¯¯?

**A**: æ£€æŸ¥æ•°æ®æ–‡ä»¶æ˜¯å¦åŒ…å«æ‰€æœ‰å¿…éœ€å­—æ®µï¼Œå­—æ®µåç§°å¿…é¡»å®Œå…¨åŒ¹é…ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ã€‚

### Q4: ä¸­æ–‡æ˜¾ç¤ºä¹±ç ?

**A**: ç¡®ä¿æ•°æ®æ–‡ä»¶ç¼–ç ä¸º UTF-8ã€‚Excelå¦å­˜ä¸ºCSVæ—¶é€‰æ‹©"UTF-8 CSV"ã€‚

### Q5: å¦‚ä½•å¯¼å‡ºå›¾è¡¨ä¸ºå›¾ç‰‡?

**A**: åœ¨å›¾è¡¨ä¸Šå³é”® -> "ä¿å­˜å›¾ç‰‡" æˆ–ä½¿ç”¨æµè§ˆå™¨çš„æˆªå›¾åŠŸèƒ½ã€‚

---

## è¿›é˜¶ç”¨æ³•

### ä¿®æ”¹é…è‰²æ–¹æ¡ˆ

ç¼–è¾‘è„šæœ¬ä¸­çš„ CSS å˜é‡:

```css
:root {
    --primary-red: #a02724;      /* æ”¹ä¸ºä½ çš„ä¸»è‰² */
    --success-green: #00b050;    /* æ”¹ä¸ºä½ çš„æˆåŠŸè‰² */
    --warning-yellow: #ffc000;   /* æ”¹ä¸ºä½ çš„è­¦å‘Šè‰² */
}
```

### æ·»åŠ è‡ªå®šä¹‰å›¾è¡¨

åœ¨ `_build_html_template()` æ–¹æ³•ä¸­æ·»åŠ æ–°çš„å›¾è¡¨é€»è¾‘ï¼Œå‚è€ƒç°æœ‰å›¾è¡¨çš„å®ç°æ–¹å¼ã€‚

### é›†æˆåˆ°è‡ªåŠ¨åŒ–æµç¨‹

```bash
# ç¤ºä¾‹: å®šæ—¶ä»»åŠ¡æ¯å‘¨äº”è‡ªåŠ¨ç”ŸæˆæŠ¥å‘Š
0 18 * * 5 cd /path/to/scripts && python generate_html_dashboard.py /data/latest.xlsx $(date +%U) å››å·åˆ†å…¬å¸ ../references
```

---

## æŠ€æœ¯æ”¯æŒ

- é—®é¢˜åé¦ˆ: æäº¤ Issue
- åŠŸèƒ½å»ºè®®: æäº¤ Feature Request
- æ–‡æ¡£æ”¹è¿›: æäº¤ Pull Request
