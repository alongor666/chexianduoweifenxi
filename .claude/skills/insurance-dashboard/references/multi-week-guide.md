# å¤šå‘¨è¶‹åŠ¿åˆ†æå®Œå…¨æŒ‡å—

## ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦å¤šå‘¨è¶‹åŠ¿åˆ†æï¼Ÿ

å•å‘¨æ•°æ®åªèƒ½æä¾›"å¿«ç…§"ï¼Œè€Œå¤šå‘¨è¶‹åŠ¿èƒ½å›ç­”ï¼š
- ğŸ“ˆ **ä¸šåŠ¡æ˜¯åœ¨å¢é•¿è¿˜æ˜¯ä¸‹æ»‘ï¼Ÿ**
- ğŸ”„ **æˆæœ¬ç‡æ³¢åŠ¨æ˜¯å¶ç„¶è¿˜æ˜¯è¶‹åŠ¿ï¼Ÿ**
- ğŸ†š **æ–°èƒ½æºè½¦è¡¨ç°æ˜¯æ”¹å–„è¿˜æ˜¯æ¶åŒ–ï¼Ÿ**
- ğŸ¢ **å“ªäº›åˆ†æ”¯æœºæ„æŒç»­ä¼˜ç§€æˆ–éœ€è¦å…³æ³¨ï¼Ÿ**

---

## ğŸ“ æ•°æ®å‡†å¤‡

### æ–¹å¼ 1: å¤šä¸ª CSV æ–‡ä»¶

æ¨èçš„æ–‡ä»¶å‘½åæ–¹å¼:
```
data/
â”œâ”€â”€ 2025ä¿å•ç¬¬42å‘¨å˜åŠ¨æˆæœ¬æ˜ç»†è¡¨.csv
â”œâ”€â”€ 2025ä¿å•ç¬¬43å‘¨å˜åŠ¨æˆæœ¬æ˜ç»†è¡¨.csv
â”œâ”€â”€ 2025ä¿å•ç¬¬44å‘¨å˜åŠ¨æˆæœ¬æ˜ç»†è¡¨.csv
â”œâ”€â”€ 2025ä¿å•ç¬¬45å‘¨å˜åŠ¨æˆæœ¬æ˜ç»†è¡¨.csv
â””â”€â”€ 2025ä¿å•ç¬¬46å‘¨å˜åŠ¨æˆæœ¬æ˜ç»†è¡¨.csv
```

### æ–¹å¼ 2: åˆå¹¶çš„å•ä¸€æ–‡ä»¶

å¦‚æœæ•°æ®å·²åˆå¹¶,ç¡®ä¿åŒ…å« `week_number` å­—æ®µ:
```csv
snapshot_date,week_number,policy_start_year,...
2025-10-19,42,2025,...
2025-10-26,43,2025,...
2025-11-02,44,2025,...
```

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹æ³• 1: é€šè¿‡ Claude å¯¹è¯ï¼ˆæœ€ç®€å•ï¼‰

ç›´æ¥å‘Šè¯‰æˆ‘:

```
æˆ‘æœ‰ç¬¬42-46å‘¨çš„ä¿å•æ•°æ®,è¯·åˆ†æè¿™5å‘¨çš„ä¸šåŠ¡è¶‹åŠ¿
```

æˆ–è€…æ›´å…·ä½“:

```
åˆ†ææœ€è¿‘5å‘¨çš„:
1. ä¿è´¹å¢é•¿è¶‹åŠ¿
2. ç»¼åˆæˆæœ¬ç‡å˜åŒ–
3. æ–°èƒ½æºè½¦å æ¯”æ¼”å˜
4. å„åˆ†æ”¯æœºæ„è¡¨ç°å¯¹æ¯”
```

æˆ‘ä¼šè‡ªåŠ¨:
1. åŠ è½½æ‰€æœ‰å‘¨çš„æ•°æ®
2. è®¡ç®—è¶‹åŠ¿æŒ‡æ ‡
3. ç”Ÿæˆäº¤äº’å¼ä»ªè¡¨æ¿
4. æä¾›æ´å¯Ÿå’Œå»ºè®®

---

### æ–¹æ³• 2: ä½¿ç”¨è„šæœ¬

```bash
# ä½¿ç”¨é€šé…ç¬¦åŠ è½½æ‰€æœ‰å‘¨æ•°æ®
python scripts/multi_week_analyzer.py "data/*å‘¨*.csv"

# æˆ–æŒ‡å®šå‘¨èŒƒå›´
python scripts/multi_week_analyzer.py data/week_{42..46}.csv

# è¾“å‡º JSON æ•°æ®
python scripts/multi_week_analyzer.py "data/*.csv" > analysis.json
```

---

## ğŸ“Š ç”Ÿæˆçš„åˆ†æå†…å®¹

### 1. æ—¶é—´åºåˆ—è¶‹åŠ¿

**åŒ…å«æŒ‡æ ‡:**
- ç­¾å•ä¿è´¹å‘¨åº¦å˜åŒ–
- èµ”ä»˜ç‡ã€è´¹ç”¨ç‡ã€ç»¼åˆæˆæœ¬ç‡èµ°åŠ¿
- è¾¹é™…è´¡çŒ®è¶‹åŠ¿
- ä¿å•ä»¶æ•°å¢é•¿æ›²çº¿
- å‡ºé™©ç‡æ³¢åŠ¨

**å¯è§†åŒ–:**
- æŠ˜çº¿å›¾å±•ç¤ºè¶‹åŠ¿
- åŒæ¯”/ç¯æ¯”å¢é•¿ç‡
- ç§»åŠ¨å¹³å‡çº¿
- é¢„è­¦é˜ˆå€¼çº¿

---

### 2. æ–°èƒ½æºè½¦æ¼”å˜åˆ†æ

**ä¼ ç»Ÿè½¦ vs æ–°èƒ½æºè½¦å¯¹æ¯”:**
- ä¿è´¹å æ¯”å˜åŒ–
- ä»¶æ•°å æ¯”æ¼”å˜
- èµ”ä»˜ç‡å·®å¼‚è¶‹åŠ¿
- ç»¼åˆæˆæœ¬ç‡æ”¶æ•›/å‘æ•£

**ç¤ºä¾‹æ´å¯Ÿ:**
```
ç¬¬42å‘¨: NEVå æ¯” 3.2%, ç»¼åˆæˆæœ¬ç‡ 125%
ç¬¬43å‘¨: NEVå æ¯” 3.8%, ç»¼åˆæˆæœ¬ç‡ 124%
ç¬¬44å‘¨: NEVå æ¯” 4.1%, ç»¼åˆæˆæœ¬ç‡ 123%
ç¬¬45å‘¨: NEVå æ¯” 4.5%, ç»¼åˆæˆæœ¬ç‡ 123%
ç¬¬46å‘¨: NEVå æ¯” 4.7%, ç»¼åˆæˆæœ¬ç‡ 122.79%

è¶‹åŠ¿: âœ“ å æ¯”æŒç»­æå‡  âœ“ æˆæœ¬ç‡å°å¹…æ”¹å–„
```

---

### 3. åˆ†æ”¯æœºæ„å¤šå‘¨è·Ÿè¸ª

**æ¯ä¸ªåˆ†æ”¯æœºæ„æ˜¾ç¤º:**
- ä¿è´¹è§„æ¨¡è¶‹åŠ¿çº¿
- ç»¼åˆæˆæœ¬ç‡å˜åŒ–
- å¸‚åœºä»½é¢æ¼”å˜
- æ’åå˜åŠ¨

**è¯†åˆ«:**
- ğŸŒŸ **æŒç»­ä¼˜ç§€**: æˆæœ¬ç‡ç¨³å®šä½äº85%
- ğŸ“ˆ **æ”¹å–„æ˜æ˜¾**: æˆæœ¬ç‡è¿ç»­3å‘¨ä¸‹é™
- âš ï¸ **éœ€è¦å…³æ³¨**: æˆæœ¬ç‡è¶…è¿‡95%
- ğŸ”´ **æŒç»­äºæŸ**: æˆæœ¬ç‡è¶…è¿‡100%

---

### 4. ä¸šåŠ¡ç±»å‹æ¼”å˜

æŒ‰ä¸šåŠ¡ç±»å‹åˆ†ç±»æŸ¥çœ‹:
- "10å¨ä»¥ä¸Š-æ™®è´§"
- "10å¨ä»¥ä¸‹-å±è´§"
- ç­‰å„ç±»ä¸šåŠ¡çš„å‘å±•è¶‹åŠ¿

**å‘ç°:**
- å“ªç±»ä¸šåŠ¡åœ¨å¢é•¿
- å“ªç±»ä¸šåŠ¡ç›ˆåˆ©æ€§æ”¹å–„
- å“ªç±»ä¸šåŠ¡éœ€è¦è°ƒæ•´ç­–ç•¥

---

## ğŸ¨ äº¤äº’å¼ä»ªè¡¨æ¿åŠŸèƒ½

### å¤šç»´åº¦åˆ‡æ¢

ä»ªè¡¨æ¿æ”¯æŒåŠ¨æ€åˆ‡æ¢æŸ¥çœ‹:

```
[æ—¶é—´èŒƒå›´é€‰æ‹©å™¨]
â–¡ æœ€è¿‘4å‘¨  â–¡ æœ€è¿‘8å‘¨  â–¡ æœ€è¿‘12å‘¨  â–¡ å…¨éƒ¨

[å¯¹æ¯”ç»´åº¦é€‰æ‹©å™¨]
â–¡ æ–°èƒ½æºè½¦ vs ä¼ ç»Ÿè½¦
â–¡ åˆ†æ”¯æœºæ„å¯¹æ¯”
â–¡ ä¸šåŠ¡ç±»å‹å¯¹æ¯”
â–¡ é£é™©ç­‰çº§å¯¹æ¯”
â–¡ é™©ç§ç±»å‹å¯¹æ¯”
```

### è”åŠ¨ç­›é€‰

ç‚¹å‡»ä»»æ„å›¾è¡¨å…ƒç´ ,å…¶ä»–å›¾è¡¨è‡ªåŠ¨ç­›é€‰:

```
ç‚¹å‡»"æ–°èƒ½æºè½¦" â†’ æ‰€æœ‰å›¾è¡¨åªæ˜¾ç¤ºæ–°èƒ½æºè½¦æ•°æ®
ç‚¹å‡»"æˆéƒ½åˆ†æ”¯" â†’ æ‰€æœ‰å›¾è¡¨åªæ˜¾ç¤ºæˆéƒ½æ•°æ®
ç‚¹å‡»"ç¬¬45å‘¨" â†’ æ‰€æœ‰å›¾è¡¨é«˜äº®è¯¥å‘¨æ•°æ®
```

### æ•°æ®é’»å–

```
æ€»è§ˆ â†’ ç‚¹å‡»ä»»æ„ç»´åº¦
  â†“
  è¯¦ç»†è¶‹åŠ¿å›¾
    â†“
    æ˜ç»†æ•°æ®è¡¨
```

---

## ğŸ’¡ åˆ†æç¤ºä¾‹

### ç¤ºä¾‹ 1: å‘ç°æˆæœ¬ç‡æ¶åŒ–

```
é—®é¢˜: ç»¼åˆæˆæœ¬ç‡ä»85%ä¸Šå‡åˆ°89%

åˆ†ææ­¥éª¤:
1. æŸ¥çœ‹è¶‹åŠ¿å›¾ â†’ ç¡®è®¤æ˜¯æŒç»­ä¸Šå‡è¿˜æ˜¯å¶ç„¶æ³¢åŠ¨
2. åˆ†è§£èµ”ä»˜ç‡å’Œè´¹ç”¨ç‡ â†’ ç¡®å®šå“ªä¸ªæ˜¯ä¸»å› 
3. æŒ‰åˆ†æ”¯æœºæ„æŸ¥çœ‹ â†’ æ˜¯å…¨é¢é—®é¢˜è¿˜æ˜¯ä¸ªåˆ«æœºæ„
4. æŒ‰ä¸šåŠ¡ç±»å‹æŸ¥çœ‹ â†’ æ˜¯å¦æŸç±»ä¸šåŠ¡æ‹–ç´¯
5. æŸ¥çœ‹æ–°èƒ½æºè½¦ â†’ NEVå æ¯”æå‡æ˜¯å¦å½±å“

ç»“è®º: 
- ä¸»å› æ˜¯æ–°èƒ½æºè½¦å æ¯”ä»3%å‡è‡³5%
- NEVç»¼åˆæˆæœ¬ç‡123%,æ‹‰é«˜æ•´ä½“æˆæœ¬
- å»ºè®®: ä¼˜åŒ–NEVå®šä»·ç­–ç•¥æˆ–æ§åˆ¶è§„æ¨¡
```

---

### ç¤ºä¾‹ 2: è¯„ä¼°åˆ†æ”¯æœºæ„

```
ç›®æ ‡: è¯†åˆ«è¡¨ç°ä¼˜ç§€å’Œéœ€è¦æ”¹è¿›çš„æœºæ„

æŸ¥çœ‹æŒ‡æ ‡:
- ä¿è´¹è§„æ¨¡: è´¡çŒ®åº¦
- ç»¼åˆæˆæœ¬ç‡: ç›ˆåˆ©èƒ½åŠ›
- è¶‹åŠ¿æ–¹å‘: æ”¹å–„è¿˜æ˜¯æ¶åŒ–

åˆ†ç±»:
ğŸŒŸ æ˜æ˜Ÿæœºæ„: å¾·é˜³(ä¿è´¹å¤§,æˆæœ¬ç‡73%)
ğŸ“ˆ è¿›æ­¥æœºæ„: èµ„é˜³(æˆæœ¬ç‡ä»85%é™è‡³80%)
âš ï¸ å…³æ³¨æœºæ„: å®œå®¾(æˆæœ¬ç‡97%,è¶…æ ‡)
ğŸ”´ é‡ç‚¹æ”¹è¿›: å—å……(æˆæœ¬ç‡æŒç»­>95%)
```

---

## ğŸ¯ é«˜çº§ç”¨æ³•

### è‡ªå®šä¹‰æ—¶é—´çª—å£

```python
# åªåˆ†æç‰¹å®šå‘¨èŒƒå›´
analyzer = MultiWeekAnalyzer('data/*.csv')
analyzer.load_multi_week_data()

# ç­›é€‰ç¬¬40-46å‘¨
df_filtered = analyzer.df_all[
    analyzer.df_all['week_number'].between(40, 46)
]
```

### æ·»åŠ é¢„æµ‹è¶‹åŠ¿

```python
# åŸºäºå†å²è¶‹åŠ¿é¢„æµ‹ä¸‹å‘¨æŒ‡æ ‡
from sklearn.linear_model import LinearRegression

weekly_metrics = analyzer.calculate_weekly_metrics()
# ... ä½¿ç”¨æœºå™¨å­¦ä¹ é¢„æµ‹
```

### å¯¹æ¯”å¤šä¸ªæ—¶é—´æ®µ

```python
# Q3 vs Q4 å¯¹æ¯”
q3_weeks = range(27, 40)  # ç¬¬27-39å‘¨
q4_weeks = range(40, 53)  # ç¬¬40-52å‘¨
```

---

## ğŸ“¤ å¯¼å‡ºä¸åˆ†äº«

### HTML äº¤äº’å¼æŠ¥å‘Š

```bash
# ç”Ÿæˆå®Œæ•´çš„äº¤äº’å¼ä»ªè¡¨æ¿
python scripts/multi_week_analyzer.py "data/*.csv" \
  --format html \
  --output weekly_trend_report.html
```

### PowerPoint æ¼”ç¤º

```bash
# ç”Ÿæˆç®¡ç†å±‚æ±‡æŠ¥PPT
python scripts/multi_week_analyzer.py "data/*.csv" \
  --format pptx \
  --output monthly_review.pptx
```

### Excel æ•°æ®è¡¨

```bash
# å¯¼å‡ºè¯¦ç»†æ•°æ®åˆ°Excel
python scripts/multi_week_analyzer.py "data/*.csv" \
  --format xlsx \
  --output trend_analysis.xlsx
```

---

## ğŸ”” æœ€ä½³å®è·µ

### 1. å®šæœŸæ›´æ–°

å»ºè®®æ¯å‘¨å›ºå®šæ—¶é—´æ›´æ–°æ•°æ®:
```bash
# æ¯å‘¨å…­è‡ªåŠ¨è¿è¡Œ
0 8 * * 6 python scripts/multi_week_analyzer.py "data/*.csv"
```

### 2. ä¿ç•™å†å²æ•°æ®

è‡³å°‘ä¿ç•™52å‘¨(ä¸€å¹´)æ•°æ®ç”¨äºåŒæ¯”åˆ†æ:
```
data/
â”œâ”€â”€ 2024/  # å»å¹´æ•°æ®
â”‚   â””â”€â”€ week_*.csv
â””â”€â”€ 2025/  # ä»Šå¹´æ•°æ®
    â””â”€â”€ week_*.csv
```

### 3. å…³æ³¨å…³é”®æŒ‡æ ‡

æ¯å‘¨å¿…çœ‹çš„3ä¸ªæŒ‡æ ‡:
1. **ç»¼åˆæˆæœ¬ç‡** - ç›ˆåˆ©èƒ½åŠ›
2. **ä¿è´¹å¢é•¿ç‡** - è§„æ¨¡å‘å±•
3. **æ–°èƒ½æºè½¦å æ¯”** - ç»“æ„å˜åŒ–

### 4. è®¾ç½®é¢„è­¦é˜ˆå€¼

```python
ALERT_THRESHOLDS = {
    'combined_ratio': 95,      # ç»¼åˆæˆæœ¬ç‡è¶…95%
    'loss_ratio': 85,          # èµ”ä»˜ç‡è¶…85%
    'week_growth': -5          # å‘¨ä¿è´¹ä¸‹é™è¶…5%
}
```

---

## ğŸ†˜ å¸¸è§é—®é¢˜

**Q: æ•°æ®é‡å¤ªå¤§å¯¼è‡´åŠ è½½æ…¢?**
A: ä½¿ç”¨åˆ†æ‰¹åŠ è½½æˆ–æ•°æ®é‡‡æ ·:
```python
# åªåŠ è½½å…³é”®å­—æ®µ
df = pd.read_csv('data.csv', usecols=[
    'week_number', 'signed_premium_yuan', 
    'reported_claim_payment_yuan', ...
])
```

**Q: å¦‚ä½•åˆå¹¶ä¸åŒæ ¼å¼çš„æ•°æ®?**
A: å…ˆæ ‡å‡†åŒ–å­—æ®µåç§°:
```python
df.rename(columns={
    'ç­¾å•ä¿è´¹': 'signed_premium_yuan',
    'èµ”æ¬¾': 'reported_claim_payment_yuan'
}, inplace=True)
```

**Q: ç¼ºå°‘æŸå‘¨æ•°æ®æ€ä¹ˆåŠ?**
A: ç³»ç»Ÿä¼šè‡ªåŠ¨è·³è¿‡,æˆ–ç”¨æ’å€¼å¡«å……:
```python
# çº¿æ€§æ’å€¼å¡«å……ç¼ºå¤±å‘¨
df_weekly = df_weekly.set_index('week_number')
df_weekly = df_weekly.interpolate(method='linear')
```

---

## ğŸ“ è¿›é˜¶å­¦ä¹ 

æ¨èé˜…è¯»:
- `references/metrics-calculation.md` - æŒ‡æ ‡è®¡ç®—å…¬å¼
- `references/data-schema.md` - æ•°æ®å­—æ®µè¯´æ˜
- `references/troubleshooting.md` - æ•…éšœæ’é™¤

éœ€è¦å¸®åŠ©? ç›´æ¥é—® Claude:
```
æˆ‘çš„å¤šå‘¨è¶‹åŠ¿å›¾æ˜¾ç¤ºå¼‚å¸¸,è¯·å¸®æˆ‘æ’æŸ¥
å¦‚ä½•è§£è¯»è¿™ä¸ªæˆæœ¬ç‡æ³¢åŠ¨?
ç»™æˆ‘ä¸€äº›æ”¹å–„å»ºè®®
```
