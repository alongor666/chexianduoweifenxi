# 自动化报告配置指南 (Config Guide)

本文档说明如何通过修改 `config.json` 来控制自动化周报的**数据阈值**、**视觉风格**及**智能文案逻辑**。

> **关联文档**: 请参考 `mckinsey-style-guide.md` 了解设计背后的原则。

## 📝 配置文件位置

`/insurance-weekly-board-report/config.json`

---

## 🎨 视觉风格配置 (Visual Style)

为了适配**麦肯锡咨询风格 (McKinsey Style)**，颜色和布局配置已做标准化更新。

### 1. 颜色方案 (Color Scheme)

默认采用 **McKinsey Red** 体系，强调极简与专业。

```json
{
  "PPT样式": {
    "风格预设": "mckinsey", // 选项: "mckinsey" (推荐) 或 "legacy" (原华安风格)

    // --- 麦肯锡风格定义 ---
    "主色调": "#a02724", // Deep Red: 用于核心数据、红线、强调项
    "辅助色": "#000000", // Black: 用于标题、正文
    "预警色": "#c00000", // Bright Red: 用于严重负面指标
    "安全色": "#228B22", // Forest Green: 用于正面指标（慎用，保持极简）
    "背景色": "#FFFFFF", // Pure White: 严禁使用渐变或底纹
    "中性灰": "#595959", // Gray: 用于图表坐标轴、次要标注

    // --- 字体与布局 ---
    "标题位置": "left", // 强制左对齐 (Left-Aligned)
    "装饰线高度": 0.015, // 顶部红线高度 (英寸)
    "标题字号": 24, // 结论性标题字号
    "正文字号": 12
  }
}
```

> **注意**: 如果需要切换回旧版蓝色风格，请将 `风格预设` 改为 `legacy`，系统将自动忽略上述颜色定义，使用内置的蓝色系。

---

## 🧠 智能文案规则 (Smart Copywriting)

这是实现 **"Title = Conclusion" (结论先行)** 的核心配置。通过配置数据范围到文案模板的映射，Agent 可以自动生成具有洞察力的标题。

### 配置结构

```json
{
  "智能文案规则": {
    "综合成本率": [
      {
        "条件": "<= 95",
        "优先级": 1,
        "标题模板": "盈利能力持续健康，综合成本率 {value}% 优于行业基准"
      },
      {
        "条件": "> 95 AND <= 100",
        "优先级": 2,
        "标题模板": "盈利水平承压：综合成本率达 {value}%，需关注赔付波动"
      },
      {
        "条件": "> 100",
        "优先级": 3,
        "标题模板": "盈利能力恶化警告：综合成本率突破 {value}%，建议立即启动风控措施"
      }
    ],
    "新能源车赔付差": [
      {
        "条件": "> 20",
        "优先级": 1,
        "标题模板": "新能源车结构性亏损：赔付率 {value}%，显著高于传统车 {diff}pp"
      }
    ],
    "保费增速": [
      {
        "条件": "> 0",
        "标题模板": "业务规模稳步扩张，同比增速 {value}%"
      },
      {
        "条件": "< 0",
        "标题模板": "业务规模收缩：同比下滑 {value}%，需分析续保流失原因"
      }
    ]
  }
}
```

**变量说明**:

- `{value}`: 当前指标的实际值。
- `{diff}`: 两个指标之间的差值（如新能源车 vs 传统车）。
- `优先级`: 当满足多个条件时，数字越大优先级越高（例如同时满足"增速>0"和"成本>100"，通常风险提示优先级更高）。

---

## 📊 业务阈值配置 (Business Thresholds)

调整数据预警的敏感度。

```json
{
  "预警阈值": {
    // 综合成本率上限（超过此值视为亚健康）
    "综合成本率_上限": 95,

    // 综合成本率危险线（超过此值标记为红色高危）
    "综合成本率_危险线": 100,

    // 新能源车赔付率与传统车的差距容忍度（百分点）
    "新能源车赔付率差距": 15,

    // 出险频度高频线（例如 25%）
    "出险频度_上限": 25,

    // 案均赔款异常线（元）
    "案均赔款_上限": 8000
  },

  "报表参数": {
    // 报告中展示前 N 个主要业务类型
    "显示TOP业务类型数": 5,

    // 报告中展示前 N 个重点机构
    "显示TOP机构数": 5,

    // 异常数据过滤（成本率超过此倍数视为脏数据或极值）
    "异常成本率阈值": 2.0
  }
}
```

---

## 🔧 常见调整场景示例

### 场景 1: 提高风险容忍度

**需求**: 业务扩张期，允许成本率暂时达到 102%。
**操作**:

1. 修改 `"综合成本率_上限": 100`
2. 修改 `"综合成本率_危险线": 105`
3. 修改 **智能文案规则** 中 `> 100` 的条件为 `> 105`。

### 场景 2: 品牌升级

**需求**: 集团统一视觉，要求 PPT 标题必须使用深蓝色。
**操作**:

1. 保持 `"风格预设": "mckinsey"` (保持布局结构)。
2. 修改 `"主色调": "#003366"` (深蓝)。
3. 修改 `"辅助色": "#003366"`。

### 场景 3: 调整“高风险”定义

**需求**: 将“新能源车赔付差”预警线从 15pp 降低到 10pp。
**操作**:

1. 修改 `"新能源车赔付率差距": 10`。
2. 确保 **智能文案规则** 中的条件也同步为 `> 10`。

---

## ⚠️ 配置规范

1.  **JSON 格式**: 严禁尾部逗号，字符串必须双引号。
2.  **颜色代码**: 必须使用 6 位 Hex 代码 (如 `#a02724`)。
3.  **生效机制**: 修改保存后，下次运行 `board_ppt_generator.py` 立即生效。
